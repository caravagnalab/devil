<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit Model Parameters — fit_devil • devil</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Model Parameters — fit_devil"><meta property="og:description" content="fit_devil performs model fitting by estimating beta coefficients, dispersion parameters,
and beta sigma. The function uses predictor variables provided in the design_matrix and a response
variable provided in the input_matrix. Optional features include the estimation of overdispersion
and the computation of size factors. The function supports parallel processing and allows customization
of various parameters such as the number of iterations, convergence tolerance, and more."><meta property="og:image" content="caravagnalab.github.io/rdevil/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">devil</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Introduction.html">Introduction to </a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/caravagnalab/devil/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Model Parameters</h1>
    <small class="dont-index">Source: <a href="https://github.com/caravagnalab/devil/R/main.R" class="external-link"><code>R/main.R</code></a></small>
    <div class="hidden name"><code>fit_devil.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>fit_devil</code> performs model fitting by estimating beta coefficients, dispersion parameters,
and beta sigma. The function uses predictor variables provided in the <code>design_matrix</code> and a response
variable provided in the <code>input_matrix</code>. Optional features include the estimation of overdispersion
and the computation of size factors. The function supports parallel processing and allows customization
of various parameters such as the number of iterations, convergence tolerance, and more.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_devil</span><span class="op">(</span></span>
<span>  <span class="va">input_matrix</span>,</span>
<span>  <span class="va">design_matrix</span>,</span>
<span>  overdispersion <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  offset <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  size_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  CUDA <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">1024L</span>,</span>
<span>  parallel.cores <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-input-matrix">input_matrix<a class="anchor" aria-label="anchor" href="#arg-input-matrix"></a></dt>
<dd><p>A numeric matrix representing the response variable, with rows corresponding to genes and columns to samples.</p></dd>


<dt id="arg-design-matrix">design_matrix<a class="anchor" aria-label="anchor" href="#arg-design-matrix"></a></dt>
<dd><p>A numeric matrix representing the predictor variables, with rows corresponding to samples and columns to predictors.</p></dd>


<dt id="arg-overdispersion">overdispersion<a class="anchor" aria-label="anchor" href="#arg-overdispersion"></a></dt>
<dd><p>Logical value indicating whether to estimate the overdispersion parameter. (default is <code>TRUE</code>)</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>A numeric vector to be included as an offset in the model. (default is <code>0</code>)</p></dd>


<dt id="arg-size-factors">size_factors<a class="anchor" aria-label="anchor" href="#arg-size-factors"></a></dt>
<dd><p>Logical value indicating whether to compute size factors for normalization. (default is <code>TRUE</code>)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical value indicating whether to display progress messages during execution. (default is <code>FALSE</code>)</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Integer specifying the maximum number of iterations allowed for the optimization process. (default is <code>500</code>)</p></dd>


<dt id="arg-tolerance">tolerance<a class="anchor" aria-label="anchor" href="#arg-tolerance"></a></dt>
<dd><p>Numeric value indicating the tolerance level for the convergence criterion. (default is <code>1e-3</code>)</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>A small numeric value added to <code>input_matrix</code> to avoid issues with non-invertible matrices. (default is <code>1e-6</code>)</p></dd>


<dt id="arg-cuda">CUDA<a class="anchor" aria-label="anchor" href="#arg-cuda"></a></dt>
<dd><p>Logical value indicating whether to use GPU version of the code (default is <code>FALSE</code>)</p></dd>


<dt id="arg-batch-size">batch_size<a class="anchor" aria-label="anchor" href="#arg-batch-size"></a></dt>
<dd><p>Integer specifying the number of genes that will be fit in each batch if <code>CUDA = TRUE</code>. (default is 1024)</p></dd>


<dt id="arg-parallel-cores">parallel.cores<a class="anchor" aria-label="anchor" href="#arg-parallel-cores"></a></dt>
<dd><p>Integer specifying the number of CPU cores to use for parallelization. If <code>NULL</code>, the maximum number of available cores are used. (defaults is <code>NULL</code>)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing the following elements:</p>
<dl><dt>beta</dt>
<dd><p>A matrix of fitted beta coefficients for each gene.</p></dd>

<dt>overdispersion</dt>
<dd><p>A numeric vector of overdispersion parameters for each gene (if estimated).</p></dd>

<dt>iterations</dt>
<dd><p>A numeric vector indicating the number of iterations taken for each gene.</p></dd>

<dt>size_factors</dt>
<dd><p>A numeric vector of size factors used for normalization.</p></dd>

<dt>offset_matrix</dt>
<dd><p>A numeric matrix of offset values used in the model.</p></dd>

<dt>design_matrix</dt>
<dd><p>The design matrix provided as input.</p></dd>

<dt>input_matrix</dt>
<dd><p>The input matrix used after processing.</p></dd>

<dt>input_parameters</dt>
<dd><p>A list of input parameters used in the function, including <code>max_iter</code>, <code>tolerance</code>, and <code>parallel.cores</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function fits model parameters, including beta coefficients, the dispersion parameter,
and beta sigma, using the provided predictor variables (<code>design_matrix</code>) and response variable (<code>input_matrix</code>).
It optionally estimates overdispersion based on the fitted model.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Giovanni Santacatterina.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

